<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
</head>
<body>
    <h1>Welcome to Bookstar!</h1>

    {% if user.is_authenticated %}
        <p>Hello, {{ user.username }}! <a href="{% url 'logout' %}">Logout</a></p>
    {% else %}
        <p><a href="{% url 'login' %}">Login</a> | <a href="{% url 'register' %}">Register</a></p>
    {% endif %}

    <h1>Books</h1>
    <ul>
        {% for book in books %}
            <li>
                <h2><a href="{% url 'book_detail' book.id %}">{{ book.title }}</a></h2>
                <p>Average Rating: {{ book.average_rating|default:"No ratings yet" }}</p>
                {% if request.user == book.upload_user %}
                    | <a href="{% url 'edit_book' book.id %}">Edit</a> | 
                    <a href="{% url 'delete_book' book.id %}">Delete</a>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
    {% if user.is_authenticated %}
    <a href="{% url 'add_author' %}">Add Author</a>
    <a href="{% url 'add_publisher' %}">Add Publisher</a>

    <h2>Add a New Book:</h2>
    <form method="post" action="{% url 'add_book' %}">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Add Book</button>
    </form>
    {% endif %}
</body>
</html>
